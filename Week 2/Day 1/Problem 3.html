<!DOCTYPE html>
<html>
<head>
    <title>Location-Based Weather Logger</title>
    <style>
        body { font-family: Arial; }
        .error { color: red; }
        .success { color: green; }
    </style>
</head>
<body>

    <h2>Location Logger</h2>

    <!-- Button -->
    <button onclick="getLocation()">Get My Location</button>

    <h3>Current Location:</h3>
    <div id="currentLocation"></div>

    <h3>Last 5 Locations:</h3>
    <ul id="locationHistory"></ul>

<script>

function getLocation() {

    if (!navigator.geolocation) {
        alert("Geolocation not supported by your browser");
        return;
    }

    navigator.geolocation.getCurrentPosition(
        successCallback,
        errorCallback,
        { timeout: 10000 }
    );
}

function successCallback(position) {

    let latitude = position.coords.latitude;
    let longitude = position.coords.longitude;

    document.getElementById("currentLocation").innerHTML =
        "Latitude: " + latitude + "<br>Longitude: " + longitude;

    saveLocation(latitude, longitude);
}

function errorCallback(error) {

    let message = "";

    switch(error.code) {
        case error.PERMISSION_DENIED:
            message = "Permission denied by user.";
            break;

        case error.TIMEOUT:
            message = "Request timed out.";
            break;

        case error.POSITION_UNAVAILABLE:
            message = "Location information unavailable.";
            break;

        default:
            message = "Unknown error occurred.";
    }

    document.getElementById("currentLocation").innerHTML =
        "<span class='error'>" + message + "</span>";
}

function saveLocation(lat, lon) {

    let locations = JSON.parse(localStorage.getItem("locationHistory")) || [];

    let newEntry = {
        latitude: lat,
        longitude: lon,
        time: new Date().toLocaleString()
    };

    // Add new entry to the beginning of the array
    locations.unshift(newEntry); 

    // Keep only the last 5 entries
    if (locations.length > 5) {
        locations.pop(); 
    }

    localStorage.setItem("locationHistory", JSON.stringify(locations));

    displayHistory();
}

function displayHistory() {

    let locations = JSON.parse(localStorage.getItem("locationHistory")) || [];

    let historyList = document.getElementById("locationHistory");
    historyList.innerHTML = "";

    locations.forEach(function(loc) {

        let li = document.createElement("li");

        li.innerHTML =
            "Lat: " + loc.latitude +
            ", Lon: " + loc.longitude +
            " (" + loc.time + ")";

        historyList.appendChild(li);
    });
}

window.onload = function() {
    displayHistory();
};

</script>

</body>
</html>